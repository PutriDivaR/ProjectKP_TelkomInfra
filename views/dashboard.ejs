<%- include('layout/header') %>
<%- include('layout/sidebar') %>

<div class="main">
  <!-- HEADER -->
  <div class="header">
    <div>
      <h1>ğŸ“Š Dashboard Monitoring RIDAR</h1>
      <p>Real-time monitoring work order dan kendala teknis</p>
    </div>
    <div>
      <button class="btn-refresh" id="refreshBtn">
        <span>ğŸ”„</span> Refresh Data
      </button>
    </div>
  </div>

  <!-- KPI SECTION -->
  <div class="kpi-section">
    <h2 class="section-title">ğŸ“ˆ Key Performance Indicators</h2>
    <div class="kpi-grid">
      <div class="kpi-card info">
        <div class="kpi-label">Total Work Orders</div>
        <div class="kpi-value" id="totalWO">0</div>
        <div class="kpi-subtitle">Semua WO aktif</div>
      </div>

      <div class="kpi-card warning">
        <div class="kpi-label">On Progress</div>
        <div class="kpi-value" id="onProgressWO">0</div>
        <div class="kpi-subtitle">Sedang dikerjakan</div>
      </div>

      <div class="kpi-card success">
        <div class="kpi-label">Completed</div>
        <div class="kpi-value" id="completeWO">0</div>
        <div class="kpi-subtitle">Selesai hari ini</div>
      </div>

      <div class="kpi-card danger">
        <div class="kpi-label">Open / Pending</div>
        <div class="kpi-value" id="openWO">0</div>
        <div class="kpi-subtitle">Belum ditangani</div>
      </div>

      <div class="kpi-card info">
        <div class="kpi-label">Avg Completion Time</div>
        <div class="kpi-value" id="avgTime">-</div>
        <div class="kpi-subtitle">Rata-rata penyelesaian</div>
      </div>

      <div class="kpi-card success">
        <div class="kpi-label">Completion Rate</div>
        <div class="kpi-value" id="completionRate">0%</div>
        <div class="kpi-subtitle">Tingkat penyelesaian</div>
      </div>
    </div>
  </div>

  <!-- REGIONAL SUMMARY -->
  <div class="kpi-section">
    <h2 class="section-title">ğŸ—ºï¸ Regional Summary</h2>
    <div class="regional-grid" id="regionalSummary">
      <!-- Will be populated by JavaScript -->
    </div>
  </div>

  <!-- WORK FULL PROCESS TABLE -->
  <div class="table-container">
    <div class="table-header">
      <h3 class="table-title">ğŸ“Š Work Full Process</h3>
    </div>
    
    <div class="table-scroll">
      <table class="table-work-full">
        <thead>
          <tr>
            <th rowspan="2">Regional</th>
            <th colspan="3">Work Fail</th>
            <th rowspan="2">Pending</th>
            <th rowspan="2">Continue</th>
            <th rowspan="2">Cancel</th>
            <th rowspan="2">Complete</th>
            <th rowspan="2">Total</th>
          </tr>
          <tr>
            <th>KDL PLG</th>
            <th>KDL TEK</th>
            <th>KDL SYS</th>
          </tr>
        </thead>
        <tbody id="workFullProcessBody">
          <tr><td colspan="9" style="text-align:center">Loading...</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- FILTERS -->
  <div class="filter-container">
    <h3 class="filter-title">ğŸ” Filter & Search</h3>
    <div class="filter-grid">
      <div class="filter-group">
        <label>Regional</label>
        <select id="filterRegional" class="filter-select">
          <option value="">Semua Regional</option>
        </select>
      </div>

      <div class="filter-group">
        <label>STO</label>
        <select id="filterSTO" class="filter-select">
          <option value="">Semua STO</option>
        </select>
      </div>

      <div class="filter-group">
        <label>Status</label>
        <select id="filterStatus" class="filter-select">
          <option value="">Semua Status</option>
          <option value="OPEN">Open</option>
          <option value="ON_PROGRESS">On Progress</option>
          <option value="COMPLETE">Complete</option>
          <option value="CANCEL">Cancel</option>
        </select>
      </div>

      <div class="filter-group">
        <label>Package</label>
        <select id="filterPackage" class="filter-select">
          <option value="">Semua Package</option>
        </select>
      </div>

      <div class="filter-group">
        <label>Start Date</label>
        <input type="date" id="filterStartDate" class="filter-input">
      </div>

      <div class="filter-group">
        <label>End Date</label>
        <input type="date" id="filterEndDate" class="filter-input">
      </div>

      <div class="filter-actions">
        <button class="btn-primary" id="applyFilter">Apply Filter</button>
        <button class="btn-secondary" id="resetFilter">Reset</button>
        <button class="btn-secondary" id="exportExcel">ğŸ“¥ Export</button>
      </div>
    </div>
  </div>

  <!-- CHARTS SECTION -->
  <div class="chart-grid">
    <!-- Status Distribution -->
    <div class="chart-card">
      <div class="chart-title">
        <span class="chart-icon">ğŸ“Š</span>
        <span>Status Distribution</span>
      </div>
      <div class="chart-wrapper">
        <canvas id="statusChart"></canvas>
      </div>
    </div>

    <!-- STO Performance -->
    <div class="chart-card">
      <div class="chart-title">
        <span class="chart-icon">ğŸ“</span>
        <span>STO Performance</span>
      </div>
      <div class="chart-wrapper">
        <canvas id="stoChart"></canvas>
      </div>
    </div>

    <!-- Trend Chart - Full Width -->
    <div class="chart-card full-width">
      <div class="chart-title">
        <span class="chart-icon">ğŸ“ˆ</span>
        <span>Work Order Trend (Last 30 Days)</span>
      </div>
      <div class="chart-wrapper tall">
        <canvas id="trendChart"></canvas>
      </div>
    </div>

    <!-- Package Distribution -->
    <div class="chart-card">
      <div class="chart-title">
        <span class="chart-icon">ğŸ“¦</span>
        <span>Package Distribution</span>
      </div>
      <div class="chart-wrapper">
        <canvas id="packageChart"></canvas>
      </div>
    </div>

    <!-- Completion Rate by STO -->
    <div class="chart-card">
      <div class="chart-title">
        <span class="chart-icon">âœ…</span>
        <span>Completion Rate by STO</span>
      </div>
      <div class="chart-wrapper">
        <canvas id="completionChart"></canvas>
      </div>
    </div>
  </div>

  <!-- WORK ORDERS TABLE -->
  <div class="table-container">
    <div class="table-header">
      <h3 class="table-title">ğŸ“‹ Work Orders</h3>
      <div class="table-scroll-btn">
        <button id="tablePrev">â†</button>
        <button id="tableNext">â†’</button>
      </div>
    </div>
    
    <div class="table-scroll">
      <table>
        <thead>
          <tr>
            <th>WO Number</th>
            <th>Customer</th>
            <th>Ticket ID</th>
            <th>Package</th>
            <th>Regional</th>
            <th>STO</th>
            <th>Status</th>
            <th>ODP</th>
            <th>Created</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody id="workOrdersBody">
          <tr><td colspan="10" style="text-align:center">Loading...</td></tr>
        </tbody>
      </table>
    </div>

    <div class="table-pager">
      <button id="pagePrev">Previous</button>
      <span class="page-info" id="pageInfo">Page 1 / 1</span>
      <button id="pageNext">Next</button>
    </div>
  </div>

  <!-- KENDALA TEKNIS TABLE -->
  <div class="table-container">
    <div class="table-header">
      <h3 class="table-title">âš ï¸ Kendala Teknis & Sistem</h3>
    </div>
    
    <div class="table-scroll">
      <table>
        <thead>
          <tr>
            <th>WO Number</th>
            <th>Unit</th>
            <th>Activity</th>
            <th>Status</th>
            <th>STO</th>
            <th>Segment</th>
            <th>Progress</th>
            <th>Solution</th>
            <th>Created</th>
          </tr>
        </thead>
        <tbody id="kendalaTeknisiBody">
          <tr><td colspan="9" style="text-align:center">Loading...</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- KENDALA PELANGGAN TABLE -->
  <div class="table-container">
    <div class="table-header">
      <h3 class="table-title">ğŸ‘¥ Kendala Pelanggan</h3>
    </div>
    
    <div class="table-scroll">
      <table>
        <thead>
          <tr>
            <th>WO Number</th>
            <th>Customer</th>
            <th>Regional</th>
            <th>STO</th>
            <th>Tanggal Input</th>
            <th>TTD KB</th>
            <th>Status HI</th>
            <th>TTIC</th>
            <th>Keterangan</th>
            <th>Nama Teknis</th>
          </tr>
        </thead>
        <tbody id="kendalaPelangganBody">
          <tr><td colspan="10" style="text-align:center">Loading...</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- WILAYAH TABLE -->
  <div class="table-container">
    <div class="table-header">
      <h3 class="table-title">ğŸ—ºï¸ Wilayah RIDAR</h3>
    </div>
    
    <div class="table-scroll">
      <table class="table-compact">
        <thead>
          <tr>
            <th>STO</th>
            <th>UIC</th>
            <th>PIC</th>
            <th>Leader</th>
            <th>Total WO</th>
            <th>Complete</th>
            <th>On Progress</th>
            <th>Completion Rate</th>
          </tr>
        </thead>
        <tbody id="wilayahBody">
          <tr><td colspan="8" style="text-align:center">Loading...</td></tr>
        </tbody>
      </table>
    </div>
  </div>

</div>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

<%- include('layout/footer') %>
